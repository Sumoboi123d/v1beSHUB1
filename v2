local Players = game:GetService('Players')
local player = Players.LocalPlayer
local toolName = "Tung Bat"
local cooldown = 0.01
local maxDuplicates = 9 -- Max 10 tools total (1 original + 9 duplicates)

-- GUI principal
local gui = Instance.new("ScreenGui", game.CoreGui)
gui.Name = "VibesHubGUI"

-- Frame principal (todo arrastável)
local frame = Instance.new("Frame")
frame.Parent = gui
frame.Size = UDim2.new(0, 180, 0, 170) -- Increased height for new button
frame.Position = UDim2.new(1, -190, 0, 10)
frame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 12)
corner.Parent = frame

-- Top bar with branding
local topBar = Instance.new("Frame")
topBar.Parent = frame
topBar.Size = UDim2.new(1, 0, 0, 24)
topBar.Position = UDim2.new(0, 0, 0, 0)
topBar.BackgroundColor3 = Color3.fromRGB(180, 0, 0)
topBar.BorderSizePixel = 0

local dragCorner = Instance.new("UICorner")
dragCorner.CornerRadius = UDim.new(0, 12)
dragCorner.Parent = topBar

-- Branding text
local title = Instance.new("TextLabel")
title.Parent = topBar
title.Size = UDim2.new(1, 0, 1, 0)
title.BackgroundTransparency = 1
title.Text = "V!BES HUB"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Font = Enum.Font.GothamBold
title.TextSize = 14

-- Lag toggle button
local lagButton = Instance.new("TextButton")
lagButton.Parent = frame
lagButton.Size = UDim2.new(1, -20, 0, 28)
lagButton.Position = UDim2.new(0, 10, 0, 32)
lagButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
lagButton.TextColor3 = Color3.fromRGB(255, 255, 255)
lagButton.Font = Enum.Font.GothamBold
lagButton.TextSize = 13
lagButton.BorderSizePixel = 0
lagButton.Text = "Lag: OFF"

local lagCorner = Instance.new("UICorner")
lagCorner.CornerRadius = UDim.new(0, 8)
lagCorner.Parent = lagButton

-- Anti-lag button
local antiLagButton = Instance.new("TextButton")
antiLagButton.Parent = frame
antiLagButton.Size = UDim2.new(1, -20, 0, 28)
antiLagButton.Position = UDim2.new(0, 10, 0, 68)
antiLagButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
antiLagButton.TextColor3 = Color3.fromRGB(255, 255, 255)
antiLagButton.Font = Enum.Font.GothamBold
antiLagButton.TextSize = 13
antiLagButton.BorderSizePixel = 0
antiLagButton.Text = "Anti-lag: OFF"

local antiLagCorner = Instance.new("UICorner")
antiLagCorner.CornerRadius = UDim.new(0, 8)
antiLagCorner.Parent = antiLagButton

-- Duplicate Auras button
local duplicateButton = Instance.new("TextButton")
duplicateButton.Parent = frame
duplicateButton.Size = UDim2.new(1, -20, 0, 28)
duplicateButton.Position = UDim2.new(0, 10, 0, 104)
duplicateButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
duplicateButton.TextColor3 = Color3.fromRGB(255, 255, 255)
duplicateButton.Font = Enum.Font.GothamBold
duplicateButton.TextSize = 13
duplicateButton.BorderSizePixel = 0
duplicateButton.Text = "Dup Auras: OFF"

local duplicateCorner = Instance.new("UICorner")
duplicateCorner.CornerRadius = UDim.new(0, 8)
duplicateCorner.Parent = duplicateButton

-- Cooldown button
local cooldownButton = Instance.new("TextButton")
cooldownButton.Parent = frame
cooldownButton.Size = UDim2.new(1, -20, 0, 28)
cooldownButton.Position = UDim2.new(0, 10, 0, 140)
cooldownButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
cooldownButton.TextColor3 = Color3.fromRGB(255, 255, 255)
cooldownButton.Font = Enum.Font.GothamBold
cooldownButton.TextSize = 13
cooldownButton.BorderSizePixel = 0
cooldownButton.Text = "Cooldown: " .. string.format("%.2f", cooldown)

local cooldownCorner = Instance.new("UICorner")
cooldownCorner.CornerRadius = UDim.new(0, 8)
cooldownCorner.Parent = cooldownButton

-- Estado
local ativo = false
local antiLagEnabled = false
local duplicateEnabled = false
local duplicatedTools = {}

-- Store connections for proper cleanup
local playerAddedConnection = nil
local characterConnections = {}

-- Function to duplicate tools
local function duplicateTools()
    if not duplicateEnabled then return end
    
    -- Clear previous duplicates
    for _, tool in pairs(duplicatedTools) do
        if tool and tool.Parent then
            tool:Destroy()
        end
    end
    duplicatedTools = {}
    
    local backpack = player:FindFirstChild("Backpack")
    local originalTool = backpack and backpack:FindFirstChild(toolName)
    
    if originalTool then
        for i = 1, maxDuplicates do
            local clone = originalTool:Clone()
            clone.Name = toolName .. "_Clone_" .. i
            clone.Parent = backpack
            table.insert(duplicatedTools, clone)
            task.wait(0.1) -- Small delay to avoid crashing
        end
    end
end

-- Function to remove duplicates
local function removeDuplicates()
    for _, tool in pairs(duplicatedTools) do
        if tool and tool.Parent then
            tool:Destroy()
        end
    end
    duplicatedTools = {}
end

-- Loop de equipar/desequipar
task.spawn(function()
    while true do
        if ativo then
            local char = player.Character
            local humanoid = char and char:FindFirstChildOfClass("Humanoid")
            
            if humanoid then
                -- Get all tools (original + duplicates)
                local allTools = {}
                local backpack = player:FindFirstChild("Backpack")
                
                if backpack then
                    for _, tool in ipairs(backpack:GetChildren()) do
                        if tool.Name == toolName or string.find(tool.Name, toolName .. "_Clone_") then
                            table.insert(allTools, tool)
                        end
                    end
                end
                
                -- Equip all tools
                for _, tool in ipairs(allTools) do
                    humanoid:EquipTool(tool)
                    task.wait(0.01) -- Tiny delay between equips
                end
                
                task.wait(cooldown)
                
                -- Unequip all tools
                humanoid:UnequipTools()
            end
        end
        task.wait(cooldown)
    end
end)

-- Clique no botão Lag
lagButton.MouseButton1Click:Connect(function()
    ativo = not ativo
    lagButton.Text = ativo and "Lag: ON" or "Lag: OFF"
    lagButton.BackgroundColor3 = ativo and Color3.fromRGB(180, 0, 0) or Color3.fromRGB(40, 40, 40)
end)

-- Anti-lag function
local function clear(char)
    if not antiLagEnabled then return end
    
    for _, v in ipairs(char:GetChildren()) do
        if v:IsA('Accessory') then
            v:Destroy()
        end
    end
    
    characterConnections[char] = char.ChildAdded:Connect(function(c)
        if antiLagEnabled and c:IsA('Accessory') then
            c:Destroy()
        end
    end)
end

local function hook(p)
    if not antiLagEnabled then return end
    
    if p.Character then
        clear(p.Character)
    end
    characterConnections[p] = p.CharacterAdded:Connect(function(char)
        if antiLagEnabled then
            clear(char)
        end
    end)
end

local function enableAntiLag()
    antiLagEnabled = true
    for _, p in ipairs(Players:GetPlayers()) do
        hook(p)
    end
    playerAddedConnection = Players.PlayerAdded:Connect(hook)
end

local function disableAntiLag()
    antiLagEnabled = false
    
    if playerAddedConnection then
        playerAddedConnection:Disconnect()
        playerAddedConnection = nil
    end
    
    for key, connection in pairs(characterConnections) do
        if connection then
            connection:Disconnect()
        end
    end
    characterConnections = {}
end

-- Clique no botão Anti-lag
antiLagButton.MouseButton1Click:Connect(function()
    if antiLagEnabled then
        disableAntiLag()
        antiLagButton.Text = "Anti-lag: OFF"
        antiLagButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    else
        enableAntiLag()
        antiLagButton.Text = "Anti-lag: ON"
        antiLagButton.BackgroundColor3 = Color3.fromRGB(180, 0, 0)
    end
end)

-- Clique no botão Duplicate
duplicateButton.MouseButton1Click:Connect(function()
    duplicateEnabled = not duplicateEnabled
    duplicateButton.Text = duplicateEnabled and "Dup Auras: ON" or "Dup Auras: OFF"
    duplicateButton.BackgroundColor3 = duplicateEnabled and Color3.fromRGB(180, 0, 0) or Color3.fromRGB(40, 40, 40)
    
    if duplicateEnabled then
        duplicateTools()
    else
        removeDuplicates()
    end
end)

-- Clique no botão Cooldown
cooldownButton.MouseButton1Click:Connect(function()
    local newCooldown = cooldown - 0.01
    if newCooldown < 0.01 then
        newCooldown = 0.20
    end
    cooldown = newCooldown
    cooldownButton.Text = "Cooldown: " .. string.format("%.2f", cooldown)
end)

-- Right-click to increase cooldown
cooldownButton.MouseButton2Click:Connect(function()
    local newCooldown = cooldown + 0.01
    if newCooldown > 0.20 then
        newCooldown = 0.01
    end
    cooldown = newCooldown
    cooldownButton.Text = "Cooldown: " .. string.format("%.2f", cooldown)
end)

-- Auto-duplicate when character respawns
player.CharacterAdded:Connect(function()
    if duplicateEnabled then
        task.wait(2) -- Wait for tools to load
        duplicateTools()
    end
end)
